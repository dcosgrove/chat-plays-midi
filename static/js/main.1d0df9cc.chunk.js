(this["webpackJsonpchat-plays-midi"]=this["webpackJsonpchat-plays-midi"]||[]).push([[0],{132:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),a=n(32),r=n.n(a),o=(n(132),n(50),n(51),n(6)),s=n(1),j="xsdpos4tnftz6tirr730o0c3u5lfsj",l=Object(c.createContext)({token:"",clientId:j,updateToken:function(){}}),d=function(e){var t=e.children,n=Object(c.useState)({token:"",expiresAt:""}),i=Object(o.a)(n,2),a=i[0],r=i[1];return Object(s.jsx)(l.Provider,{value:{token:a.token,clientId:j,updateToken:function(e,t){r({token:e,expiresAt:t})}},children:t})},b=n(8);var u=function(){var e=Object(c.useContext)(l).updateToken,t=document.location.hash.split("&")[0].replace("#access_token=","");return Object(c.useEffect)((function(){var n=Date.now();console.group("updating with",t,n),e(t,n)})),Object(s.jsx)("div",{children:""!==t?Object(s.jsx)(b.a,{replace:!0,to:"/"}):"Authorizing..."})},h=n(23),O=n(52),v=n(122);var x=function(e,t,n){var i=Object(c.useState)(null),a=Object(o.a)(i,2),r=a[0],s=a[1],j=Object(c.useState)("disconnected"),l=Object(o.a)(j,2),d=l[0],b=l[1];return Object(c.useEffect)((function(){if(!r&&""!==t){console.log("setting up pubsub client...");var c=new O.StaticAuthProvider(e,t),i=new v.SingleUserPubSubClient({authProvider:c});b("connecting"),i.onRedemption((function(e){var t=e.id,c=e.userDisplayName,i=e.rewardTitle,a=e.redemptionDate;n({id:t,userDisplayName:c,rewardTitle:i,redemptionDate:a})}),(function(e){throw e})),s(i),function(e,t){setInterval((function(){var n=e._pubSubClient,c=n.isConnected,i=n.isConnecting;t((function(){return c?"connected":i?"connecting":"disconnected"}))}),1e3)}(i,b)}}),[r,e,n,t]),d},f=Object(c.createContext)({events:[],registerEventListeners:function(e){},connectionStatus:"disconnected"}),p=function(e){var t=e.children,n=Object(c.useState)([]),i=Object(o.a)(n,2),a=i[0],r=i[1],j=Object(c.useContext)(l),d=j.clientId,b=j.token,u=Object(c.useState)([]),O=Object(o.a)(u,2),v=O[0],p=O[1];Object(c.useEffect)((function(){if(a.length>0){var e=a[a.length-1].rewardTitle;v.forEach((function(t){var n=t.condition,c=t.action;"channelPoint"===n.type&&n.name===e&&(console.log("[Channel Point Redemption] Firing action for ".concat(e)),c())}))}}),[a]);var m=x(d,b,(function(e){var t=e.userDisplayName,n=e.rewardTitle,c=e.redemptionDate;r((function(e){return[].concat(Object(h.a)(e),[{userDisplayName:t,rewardTitle:n,redemptionDate:c}])}))}));return Object(s.jsx)(f.Provider,{value:{events:a,registerEventListeners:function(e){p((function(t){return[].concat(Object(h.a)(t),Object(h.a)(e))}))},connectionStatus:m},children:t})},m=n(205),g=n(214),D=n(201),y=n(202),C=n(123),T=n(203),w=n(204),I={kemper:"Kemper Profiler","neural-henson":"Neural DSP Archetype: Tim Henson","neural-gojira":"Neural DSP Archetype: Gojira"},k=n(91),S=n.n(k);var A=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(c.useEffect)((function(){S.a.enable((function(e){e?(console.error("Unable to enable WebMIDI",e),i([])):i(S.a.outputs)}))}),[]),n},E=Object(c.createContext)({devices:[],setDevices:function(){},midiOutputs:[]}),P=function(e){var t=e.children,n=A(),i=Object(c.useState)([]),a=Object(o.a)(i,2),r=a[0],j=a[1];return Object(s.jsx)(E.Provider,{value:{devices:r,setDevices:j,midiOutputs:n},children:t})};var M=function(){var e=Object(c.useContext)(E),t=e.devices,n=e.setDevices;return Object(s.jsx)(D.a,{fluid:!0,children:Object(s.jsx)(y.a,{children:Object(s.jsxs)(C.a,{children:[Object(s.jsxs)(T.a,{striped:!0,bordered:!0,variant:"light",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Alias"}),Object(s.jsx)("th",{children:"ID"}),Object(s.jsx)("th",{children:"Type"}),Object(s.jsx)("th",{})]})}),Object(s.jsx)("tbody",{children:t.map((function(e){return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:e.alias}),Object(s.jsx)("td",{children:e.id}),Object(s.jsx)("td",{children:I[e.type]}),Object(s.jsx)("td",{children:Object(s.jsx)(w.a,{variant:"danger",onClick:function(){var c;c=e.id,n(t.filter((function(e){return e.id!==c})))},children:"Remove"})})]},e.key)}))})]}),0===t.length?Object(s.jsx)("h2",{children:"Add a new MIDI device to get started!"}):null]})})})},N=n(2),R=n(211),L=n(124),z=function(e,t){return{"Delay On":function(){e.sendControlChange(27,1,t)},"Delay Off":function(){e.sendControlChange(27,0,t)}}},K=[["Toggle Overdrive",2],["Toggle Distortion",3],["Toggle Phaser",4],["Toggle Chorus",5],["Toggle Reverb",7],["Toggle Delay",8]],_=function(e,t){return K.reduce((function(n,c){var i=Object(o.a)(c,2),a=i[0],r=i[1];return n[a]=function(){e.sendControlChange(r,1,t)},n}),{})};var U=function(){var e=Object(c.useState)({alias:"My Example Device",type:"",midiDevice:"",midiChannel:""}),t=Object(o.a)(e,2),n=t[0],i=t[1],a=Object(c.useContext)(E),r=a.devices,j=a.setDevices,l=a.midiOutputs;return Object(s.jsx)(D.a,{children:Object(s.jsx)(y.a,{children:Object(s.jsxs)(R.a,{children:[Object(s.jsx)(y.a,{children:Object(s.jsxs)(R.a.Group,{className:"mb-3",controlId:"formDeviceAlias",children:[Object(s.jsx)(R.a.Label,{children:"Device Name"}),Object(s.jsx)(R.a.Control,{value:n.alias,onChange:function(e){i(Object(N.a)(Object(N.a)({},n),{},{alias:e.target.value}))},type:"text"}),Object(s.jsx)(R.a.Text,{className:"text-muted",children:"Enter a name for the MIDI device you want to control"})]})}),Object(s.jsxs)(y.a,{className:"mb-3",children:[Object(s.jsx)(C.a,{md:!0,children:Object(s.jsx)(L.a,{controlId:"formDeviceType",label:"Device Type",children:Object(s.jsxs)(R.a.Select,{value:n.type,onChange:function(e){i(Object(N.a)(Object(N.a)({},n),{},{type:e.target.value}))},"aria-label":"Device Type",children:[Object(s.jsx)("option",{value:""}),Object.entries(I).map((function(e){var t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(s.jsx)("option",{value:n,children:c},n)}))]})})}),Object(s.jsx)(C.a,{md:!0,children:Object(s.jsx)(L.a,{controlId:"formMidiDevice",label:"MIDI Device",children:Object(s.jsxs)(R.a.Select,{value:n.midiDevice,onChange:function(e){i(Object(N.a)(Object(N.a)({},n),{},{midiDevice:e.target.value}))},"aria-label":"MIDI Device",children:[Object(s.jsx)("option",{value:""}),l.map((function(e){return Object(s.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id)}))]})})}),Object(s.jsx)(C.a,{md:!0,children:Object(s.jsx)(L.a,{controlId:"formChannel",label:"MIDI Channel",children:Object(s.jsxs)(R.a.Select,{value:n.midiChannel,onChange:function(e){i(Object(N.a)(Object(N.a)({},n),{},{midiChannel:e.target.value}))},"aria-label":"MIDI Channel",children:[Object(s.jsx)("option",{value:""}),Object(h.a)(Array(16)).map((function(e,t){return Object(s.jsx)("option",{value:t+1,children:t+1},t)}))]})})})]}),Object(s.jsx)(y.a,{children:Object(s.jsx)(w.a,{onClick:function(){!function(e){var t,n,c;r.some((function(t){return t.key===e.key}))||j([].concat(Object(h.a)(r),[Object(N.a)(Object(N.a)({},e),{},{effects:(t=e.output,n=e.midiChannel,c=e.type,"kemper"===c?z(t,n):"neural-henson"===c||"neural-gojira"===c?_(t,n):[])})]))}({key:[n.midiDevice,"-",n.midiChannel].join(""),id:[n.midiDevice,"-",n.midiChannel].join(""),alias:n.alias,channel:n.midiChannel,type:n.type,output:l.find((function(e){return e.id===n.midiDevice}))})},variant:"primary",children:"Add Device"})})]})})})};var B=function(){var e=Object(c.useContext)(E).devices.reduce((function(e,t){var n=Object.entries(t.effects).map((function(e){var n=Object(o.a)(e,2),c=n[0],i=n[1];return{key:"".concat(t.key,"-").concat(c),deviceAlias:t.alias,name:c,trigger:i}}));return[].concat(Object(h.a)(e),Object(h.a)(n))}),[]);return Object(s.jsx)(D.a,{fluid:!0,children:Object(s.jsx)(y.a,{children:Object(s.jsx)(C.a,{children:Object(s.jsxs)(T.a,{striped:!0,bordered:!0,variant:"light",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Device"}),Object(s.jsx)("th",{children:"Effect"}),Object(s.jsx)("th",{children:"Test"})]})}),Object(s.jsx)("tbody",{children:e.map((function(e){return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:e.deviceAlias}),Object(s.jsx)("td",{children:e.name}),Object(s.jsx)("td",{children:Object(s.jsx)(w.a,{onClick:function(){e.trigger()},children:"Trigger"})})]},e.key)}))})]})})})})},G=n(213);var J=function(){var e=Object(c.useContext)(f),t=e.events;return e.onNewEvent,Object(s.jsxs)(D.a,{children:[Object(s.jsx)("h2",{children:"Most Recent Events"}),Object(s.jsx)(G.a,{children:t.map((function(e){var t=e.userDisplayName,n=e.rewardTitle,c=e.redemptionDate;return Object(s.jsx)(G.a.Item,{children:"Username: ".concat(t," | Reward: ").concat(n," | Date: ").concat(c)},"".concat(t,"-").concat(c))}))})]})};var F=function(){var e=Object(c.useContext)(f).registerEventListeners,t=Object(c.useContext)(E).devices,n=Object(c.useState)([]),i=Object(o.a)(n,2),a=i[0],r=i[1];return Object(c.useEffect)((function(){if(t.length>0){var n=t[0],c={id:1,device:n.alias,condition:{type:"channelPoint",name:"Tone: Toggle Reverb"},action:n.effects["Toggle Reverb"]},i={id:2,device:n.alias,condition:{type:"channelPoint",name:"Tone: Toggle Delay"},action:n.effects["Toggle Delay"]},o={id:3,device:n.alias,condition:{type:"channelPoint",name:"Tone: Toggle OD"},action:n.effects["Toggle Overdrive"]};e([c,i,o]),r([].concat(Object(h.a)(a),[c,i,o]))}}),[t]),Object(s.jsx)(D.a,{children:Object(s.jsx)(G.a,{children:a.map((function(e){var t=e.id,n=e.condition,c=e.device;return Object(s.jsx)(G.a.Item,{children:"ID: ".concat(t," | Twitch Event: ").concat(n.name," | Device: ").concat(c," }")},t)}))})})};var H=function(){return Object(s.jsxs)(P,{children:[Object(s.jsxs)(m.a,{defaultActiveKey:"browser",id:"browser",className:"mb-3",children:[Object(s.jsx)(g.a,{eventKey:"triggers",title:"Triggers",children:Object(s.jsx)(F,{})}),Object(s.jsx)(g.a,{eventKey:"previewEffects",title:"Preview Effects",children:Object(s.jsx)(B,{})}),Object(s.jsxs)(g.a,{eventKey:"midiDevices",title:"Manage MIDI Devices",children:[Object(s.jsx)(M,{}),Object(s.jsx)(U,{})]})]}),Object(s.jsx)("hr",{}),Object(s.jsx)(J,{})]})},W=n(212);var q=function(e){var t=Object(c.useContext)(l),n=t.clientId,i=""!==t.token,a="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname,"authorize");return i?e.children:Object(s.jsx)(W.a,{children:Object(s.jsx)(W.a.Body,{children:Object(s.jsx)(w.a,{onClick:function(){window.location.href="https://id.twitch.tv/oauth2/authorize?client_id=".concat(n,"&redirect_uri=").concat(a,"&response_type=token&scope=bits%3Aread%20channel%3Aread%3Aredemptions%20channel%3Aread%3Asubscriptions")},children:"Connect to Twitch"})})})};var Q=function(){return Object(s.jsx)("h2",{children:"Invalid URL - page not found"})},V=n(210),X=n(126),Y=n(90),Z=n(207),$=n(209),ee=n(206),te=n(208);var ne=function(){switch(Object(c.useContext)(f).connectionStatus){case"connected":return Object(s.jsxs)(ee.a,{variant:"success",children:[" ",Object(s.jsx)(Z.a,{color:"green"})," Connected to Twitch"]});case"connecting":return Object(s.jsxs)(ee.a,{variant:"primary",children:[" ",Object(s.jsx)(te.a,{size:"sm",animation:"border"})," Connecting..."]});case"disconnected":return Object(s.jsxs)(ee.a,{variant:"danger",children:[Object(s.jsx)($.a,{color:"red"})," Disconnected from Twitch!"]});default:return Object(s.jsx)(ee.a,{variant:"warning",children:"Error checking connection status"})}};var ce=function(){return Object(s.jsx)(d,{children:Object(s.jsx)(p,{children:Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)(V.a,{bg:"light",expand:"lg",children:Object(s.jsxs)(D.a,{children:[Object(s.jsx)(V.a.Brand,{children:"Chat Plays MIDI"}),Object(s.jsx)(X.a.Item,{children:Object(s.jsx)(ne,{})}),Object(s.jsx)(X.a.Link,{href:"#setup",children:"Setup Guide"}),Object(s.jsx)(X.a.Link,{href:"#contact",children:"Contact"})]})}),Object(s.jsx)(D.a,{children:Object(s.jsx)(Y.a,{basename:"/chat-plays-midi",children:Object(s.jsxs)(b.d,{children:[Object(s.jsx)(b.b,{path:"/",element:Object(s.jsx)(D.a,{children:Object(s.jsx)(q,{children:Object(s.jsx)(H,{})})})}),Object(s.jsx)(b.b,{path:"/authorize",element:Object(s.jsx)(u,{})}),Object(s.jsx)(b.b,{path:"/*",element:Object(s.jsx)(Q,{})})]})})})]})})})};r.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(ce,{})}),document.getElementById("root"))},50:function(e,t,n){}},[[197,1,2]]]);
//# sourceMappingURL=main.1d0df9cc.chunk.js.map