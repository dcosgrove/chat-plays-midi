(this["webpackJsonpchat-plays-midi"]=this["webpackJsonpchat-plays-midi"]||[]).push([[0],{132:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),r=n(32),a=n.n(r),s=(n(132),n(50),n(51),n(6)),o=n(1),j="xsdpos4tnftz6tirr730o0c3u5lfsj",l=Object(c.createContext)({token:"",clientId:j,updateToken:function(){}}),d=function(e){var t=e.children,n=Object(c.useState)({token:"",expiresAt:""}),i=Object(s.a)(n,2),r=i[0],a=i[1];return Object(o.jsx)(l.Provider,{value:{token:r.token,clientId:j,updateToken:function(e,t){a({token:e,expiresAt:t})}},children:t})},b=n(8);var u=function(){var e=Object(c.useContext)(l).updateToken,t=document.location.hash.split("&")[0].replace("#access_token=","");return Object(c.useEffect)((function(){var n=Date.now();console.group("updating with",t,n),e(t,n)})),Object(o.jsx)("div",{children:""!==t?Object(o.jsx)(b.a,{replace:!0,to:"/"}):"Authorizing..."})},h=n(23),O=n(53),x=n(122);var v=function(e,t,n){var i=Object(c.useState)(null),r=Object(s.a)(i,2),a=r[0],o=r[1],j=Object(c.useState)("disconnected"),l=Object(s.a)(j,2),d=l[0],b=l[1];return Object(c.useEffect)((function(){if(!a&&""!==t){console.log("setting up pubsub client...");var c=new O.StaticAuthProvider(e,t),i=new x.SingleUserPubSubClient({authProvider:c});b("connecting"),i.onRedemption((function(e){var t=e.id,c=e.userDisplayName,i=e.rewardTitle,r=e.redemptionDate;n({id:t,userDisplayName:c,rewardTitle:i,redemptionDate:r})}),(function(e){throw e})),o(i),function(e,t){setInterval((function(){var n=e._pubSubClient,c=n.isConnected,i=n.isConnecting;t((function(){return c?"connected":i?"connecting":"disconnected"}))}),1e3)}(i,b)}}),[a,e,n,t]),d},f=Object(c.createContext)({events:[],registerEventListeners:function(e){},unregisterEventListener:function(e){},eventListeners:[],connectionStatus:"disconnected"}),m=function(e){var t=e.children,n=Object(c.useState)([]),i=Object(s.a)(n,2),r=i[0],a=i[1],j=Object(c.useContext)(l),d=j.clientId,b=j.token,u=Object(c.useState)([]),O=Object(s.a)(u,2),x=O[0],m=O[1];Object(c.useEffect)((function(){if(r.length>0){var e=r[r.length-1].rewardTitle;x.forEach((function(t){var n=t.condition,c=t.effects;"channelPoint"===n.type&&n.name===e&&c.forEach((function(e){return(0,e.exec)()}))}))}}),[r]);var p=v(d,b,(function(e){var t=e.userDisplayName,n=e.rewardTitle,c=e.redemptionDate;a((function(e){return[].concat(Object(h.a)(e),[{userDisplayName:t,rewardTitle:n,redemptionDate:c}])}))}));return Object(o.jsx)(f.Provider,{value:{events:r,registerEventListeners:function(e){m((function(t){return[].concat(Object(h.a)(t),Object(h.a)(e))}))},unregisterEventListener:function(e){m((function(t){return t.filter((function(t){return t.id!==e}))}))},eventListeners:x,connectionStatus:p},children:t})},p=n(205),g=n(214),y=n(201),C=n(202),D=n(123),w=n(203),I=n(204),T={kemper:"Kemper Profiler","neural-henson":"Neural DSP Archetype: Tim Henson","neural-gojira":"Neural DSP Archetype: Gojira"},k=n(91),E=n.n(k);var S=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],i=t[1];return Object(c.useEffect)((function(){E.a.enable((function(e){e?(console.error("Unable to enable WebMIDI",e),i([])):i(E.a.outputs)}))}),[]),n},A=Object(c.createContext)({devices:[],setDevices:function(){},midiOutputs:[]}),N=function(e){var t=e.children,n=S(),i=Object(c.useState)([]),r=Object(s.a)(i,2),a=r[0],j=r[1];return Object(o.jsx)(A.Provider,{value:{devices:a,setDevices:j,midiOutputs:n},children:t})};var P=function(){var e=Object(c.useContext)(A),t=e.devices,n=e.setDevices;return Object(o.jsx)(y.a,{fluid:!0,children:Object(o.jsx)(C.a,{children:Object(o.jsxs)(D.a,{children:[Object(o.jsxs)(w.a,{striped:!0,bordered:!0,variant:"light",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"Alias"}),Object(o.jsx)("th",{children:"ID"}),Object(o.jsx)("th",{children:"Type"}),Object(o.jsx)("th",{})]})}),Object(o.jsx)("tbody",{children:t.map((function(e){return Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:e.alias}),Object(o.jsx)("td",{children:e.id}),Object(o.jsx)("td",{children:T[e.type]}),Object(o.jsx)("td",{children:Object(o.jsx)(I.a,{variant:"danger",onClick:function(){var c;c=e.id,n(t.filter((function(e){return e.id!==c})))},children:"Remove"})})]},e.key)}))})]}),0===t.length?Object(o.jsx)("h2",{children:"Add a new MIDI device to get started!"}):null]})})})},M=n(2),L=n(211),R=n(124),z=function(e,t){return{"Delay On":function(){e.sendControlChange(27,1,t)},"Delay Off":function(){e.sendControlChange(27,0,t)}}},K=[["Toggle Overdrive",2],["Toggle Distortion",3],["Toggle Phaser",4],["Toggle Chorus",5],["Toggle Reverb",7],["Toggle Delay",8]],_=function(e,t){return K.reduce((function(n,c){var i=Object(s.a)(c,2),r=i[0],a=i[1];return n[r]=function(){e.sendControlChange(a,1,t)},n}),{})};var B=function(){var e=Object(c.useState)({alias:"My Example Device",type:"",midiDevice:"",midiChannel:""}),t=Object(s.a)(e,2),n=t[0],i=t[1],r=Object(c.useContext)(A),a=r.devices,j=r.setDevices,l=r.midiOutputs;return Object(o.jsx)(y.a,{children:Object(o.jsx)(C.a,{children:Object(o.jsxs)(L.a,{children:[Object(o.jsx)(C.a,{children:Object(o.jsxs)(L.a.Group,{className:"mb-3",controlId:"formDeviceAlias",children:[Object(o.jsx)(L.a.Label,{children:"Device Name"}),Object(o.jsx)(L.a.Control,{value:n.alias,onChange:function(e){i(Object(M.a)(Object(M.a)({},n),{},{alias:e.target.value}))},type:"text"}),Object(o.jsx)(L.a.Text,{className:"text-muted",children:"Enter a name for the MIDI device you want to control"})]})}),Object(o.jsxs)(C.a,{className:"mb-3",children:[Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"formDeviceType",label:"Device Type",children:Object(o.jsxs)(L.a.Select,{value:n.type,onChange:function(e){i(Object(M.a)(Object(M.a)({},n),{},{type:e.target.value}))},"aria-label":"Device Type",children:[Object(o.jsx)("option",{value:""}),Object.entries(T).map((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(o.jsx)("option",{value:n,children:c},n)}))]})})}),Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"formMidiDevice",label:"MIDI Device",children:Object(o.jsxs)(L.a.Select,{value:n.midiDevice,onChange:function(e){i(Object(M.a)(Object(M.a)({},n),{},{midiDevice:e.target.value}))},"aria-label":"MIDI Device",children:[Object(o.jsx)("option",{value:""}),l.map((function(e){return Object(o.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id)}))]})})}),Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"formChannel",label:"MIDI Channel",children:Object(o.jsxs)(L.a.Select,{value:n.midiChannel,onChange:function(e){i(Object(M.a)(Object(M.a)({},n),{},{midiChannel:e.target.value}))},"aria-label":"MIDI Channel",children:[Object(o.jsx)("option",{value:""}),Object(h.a)(Array(16)).map((function(e,t){return Object(o.jsx)("option",{value:t+1,children:t+1},t)}))]})})})]}),Object(o.jsx)(C.a,{children:Object(o.jsx)(I.a,{onClick:function(){!function(e){var t,n,c;a.some((function(t){return t.key===e.key}))||j([].concat(Object(h.a)(a),[Object(M.a)(Object(M.a)({},e),{},{effects:(t=e.output,n=e.midiChannel,c=e.type,"kemper"===c?z(t,n):"neural-henson"===c||"neural-gojira"===c?_(t,n):[])})]))}({key:[n.midiDevice,"-",n.midiChannel].join(""),id:[n.midiDevice,"-",n.midiChannel].join(""),alias:n.alias,channel:n.midiChannel,type:n.type,output:l.find((function(e){return e.id===n.midiDevice}))})},variant:"primary",children:"Add Device"})})]})})})};var U=function(){var e=Object(c.useContext)(A).devices.reduce((function(e,t){var n=Object.entries(t.effects).map((function(e){var n=Object(s.a)(e,2),c=n[0],i=n[1];return{key:"".concat(t.key,"-").concat(c),deviceAlias:t.alias,name:c,trigger:i}}));return[].concat(Object(h.a)(e),Object(h.a)(n))}),[]);return Object(o.jsx)(y.a,{fluid:!0,children:Object(o.jsx)(C.a,{children:Object(o.jsx)(D.a,{children:Object(o.jsxs)(w.a,{striped:!0,bordered:!0,variant:"light",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"Device"}),Object(o.jsx)("th",{children:"Effect"}),Object(o.jsx)("th",{children:"Test"})]})}),Object(o.jsx)("tbody",{children:e.map((function(e){return Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:e.deviceAlias}),Object(o.jsx)("td",{children:e.name}),Object(o.jsx)("td",{children:Object(o.jsx)(I.a,{onClick:function(){e.trigger()},children:"Trigger"})})]},e.key)}))})]})})})})},G=n(213);var V=function(){var e=Object(c.useContext)(f),t=e.events;return e.onNewEvent,Object(o.jsxs)(y.a,{children:[Object(o.jsx)("h2",{children:"Most Recent Events"}),Object(o.jsx)(G.a,{children:t.map((function(e){var t=e.userDisplayName,n=e.rewardTitle,c=e.redemptionDate;return Object(o.jsx)(G.a.Item,{children:"Username: ".concat(t," | Reward: ").concat(n," | Date: ").concat(c)},"".concat(t,"-").concat(c))}))})]})},J=function(e){var t=e.type,n=e.name;return"channelPoint"===t?"[Channel Points] ".concat(n):"Error"};var H=function(){var e=Object(c.useContext)(f),t=e.eventListeners,n=e.unregisterEventListener;return Object(o.jsx)(y.a,{fluid:!0,children:Object(o.jsx)(C.a,{children:Object(o.jsx)(D.a,{children:Object(o.jsxs)(w.a,{striped:!0,bordered:!0,variant:"light",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"Twitch Event"}),Object(o.jsx)("th",{children:"Device"}),Object(o.jsx)("th",{children:"Effects"}),Object(o.jsx)("th",{})]})}),Object(o.jsx)("tbody",{children:t.map((function(e){var t=e.id,c=e.condition,i=e.device,r=e.effects;return console.log("device id",t),Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:J(c)}),Object(o.jsx)("td",{children:i.alias}),Object(o.jsx)("td",{children:r.reduce((function(e,t){return e+" "+t.name}),"")}),Object(o.jsx)("td",{children:Object(o.jsx)(I.a,{variant:"danger",onClick:function(){n(t)},children:"Remove"})})]},t)}))})]})})})})};var W=function(){var e=Object(c.useState)({device:{effects:[]},condition:{type:"",name:""},effects:[]}),t=Object(s.a)(e,2),n=t[0],i=n.device,r=n.condition,a=n.effects,j=t[1],l=Object(c.useContext)(A).devices,d=Object(c.useContext)(f).registerEventListeners;return Object(o.jsx)(y.a,{children:Object(o.jsx)(C.a,{children:Object(o.jsxs)(L.a,{children:[Object(o.jsxs)(C.a,{className:"mb-3",children:[Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"formTwitchEvent",label:"Twitch Event Type",children:Object(o.jsxs)(L.a.Select,{value:r.type,onChange:function(e){j((function(t){return Object(M.a)(Object(M.a)({},t),{},{condition:{name:t.condition.name,type:e.target.value}})}))},"aria-label":"Device Type",children:[Object(o.jsx)("option",{value:""}),Object(o.jsx)("option",{value:"channelPoint",children:"Channel Points"}),Object(o.jsx)("option",{value:"bits",children:"Bits"}),Object(o.jsx)("option",{value:"subscriptions",children:"Subscriptions"})]})})}),Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"floatingInputGrid",label:"Twitch Event: Value",children:Object(o.jsx)(L.a.Control,{type:"text",value:r.name,onChange:function(e){j((function(t){return Object(M.a)(Object(M.a)({},t),{},{condition:{type:t.condition.type,name:e.target.value}})}))},placeholder:"Tone: Toggle Reverb"})})}),Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"formDevice",label:"Device",children:Object(o.jsxs)(L.a.Select,{value:i.id,onChange:function(e){j((function(t){return Object(M.a)(Object(M.a)({},t),{},{device:l.find((function(t){return t.id===e.target.value}))||{effects:[]}})}))},"aria-label":"Device",children:[Object(o.jsx)("option",{value:""}),l.map((function(e){var t=e.alias,n=e.key,c=e.id;return Object(o.jsx)("option",{value:c,children:t},n)}))]})})}),Object(o.jsx)(D.a,{md:!0,children:Object(o.jsx)(R.a,{controlId:"formEffects",label:"Effects",children:Object(o.jsxs)(L.a.Select,{value:a,onChange:function(e){j((function(t){return Object(M.a)(Object(M.a)({},t),{},{effects:e.target.value})}))},"aria-label":"MIDI Channel",children:[Object(o.jsx)("option",{value:""}),Object.keys(i.effects).map((function(e){return Object(o.jsx)("option",{value:e,children:e},e)}))]})})})]}),Object(o.jsx)(C.a,{children:Object(o.jsx)(I.a,{onClick:function(){!function(e){var t={id:"".concat(e.device.alias,"-").concat(e.condition.type,"-").concat(e.condition.name),device:e.device,condition:e.condition,effects:[{name:e.effects,exec:e.device.effects[e.effects]}]};d([t])}({device:i,condition:r,effects:a})},variant:"primary",children:"Add Trigger"})})]})})})};var q=function(){return Object(o.jsxs)(N,{children:[Object(o.jsxs)(p.a,{defaultActiveKey:"browser",id:"browser",className:"mb-3",children:[Object(o.jsxs)(g.a,{eventKey:"triggers",title:"Triggers",children:[Object(o.jsx)(H,{}),Object(o.jsx)(W,{})]}),Object(o.jsx)(g.a,{eventKey:"previewEffects",title:"Preview Effects",children:Object(o.jsx)(U,{})}),Object(o.jsxs)(g.a,{eventKey:"midiDevices",title:"Manage MIDI Devices",children:[Object(o.jsx)(P,{}),Object(o.jsx)(B,{})]})]}),Object(o.jsx)("hr",{}),Object(o.jsx)(V,{})]})},F=n(212),Q=n(215);var X=function(e){var t=Object(c.useContext)(l),n=t.clientId,i=""!==t.token,r="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname,"authorize");return i?e.children:Object(o.jsx)(F.a,{className:"mt-3",children:Object(o.jsx)(F.a.Body,{children:Object(o.jsxs)(Q.a,{direction:"horizontal",gap:2,children:[Object(o.jsx)("div",{children:"Connect your Twitch.TV account in order to get started:"}),Object(o.jsx)(I.a,{onClick:function(){window.location.href="https://id.twitch.tv/oauth2/authorize?client_id=".concat(n,"&redirect_uri=").concat(r,"&response_type=token&scope=bits%3Aread%20channel%3Aread%3Aredemptions%20channel%3Aread%3Asubscriptions")},children:"Twitch.TV Login"})]})})})};var Y=function(){return Object(o.jsx)("h2",{children:"Invalid URL - page not found"})},Z=n(210),$=n(126),ee=n(90),te=n(207),ne=n(209),ce=n(206),ie=n(208);var re=function(){switch(Object(c.useContext)(f).connectionStatus){case"connected":return Object(o.jsxs)(ce.a,{variant:"success",className:"mb-0",children:[" ",Object(o.jsx)(te.a,{color:"green"})," Connected to Twitch"]});case"connecting":return Object(o.jsxs)(ce.a,{variant:"primary",className:"mb-0",children:[" ",Object(o.jsx)(ie.a,{size:"sm",animation:"border"})," Connecting..."]});case"disconnected":return Object(o.jsxs)(ce.a,{variant:"danger",className:"mb-0",children:[Object(o.jsx)(ne.a,{color:"red"})," Disconnected from Twitch!"]});default:return Object(o.jsx)(ce.a,{variant:"warning",children:"Error checking connection status"})}};var ae=function(){return Object(o.jsx)(d,{children:Object(o.jsx)(m,{children:Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(Z.a,{variant:"dark",bg:"dark",expand:"sm",className:"mb-3",children:Object(o.jsxs)(y.a,{children:[Object(o.jsx)(Z.a.Brand,{children:"Chat Plays MIDI"}),Object(o.jsx)($.a,{className:"me-auto"}),Object(o.jsx)($.a.Item,{children:Object(o.jsx)(y.a,{children:Object(o.jsx)(re,{})})})]})}),Object(o.jsx)(y.a,{children:Object(o.jsx)(ee.a,{basename:"/chat-plays-midi",children:Object(o.jsxs)(b.d,{children:[Object(o.jsx)(b.b,{path:"/",element:Object(o.jsx)(y.a,{children:Object(o.jsx)(X,{children:Object(o.jsx)(q,{})})})}),Object(o.jsx)(b.b,{path:"/authorize",element:Object(o.jsx)(u,{})}),Object(o.jsx)(b.b,{path:"/*",element:Object(o.jsx)(Y,{})})]})})})]})})})};a.a.render(Object(o.jsx)(i.a.StrictMode,{children:Object(o.jsx)(ae,{})}),document.getElementById("root"))},50:function(e,t,n){}},[[197,1,2]]]);
//# sourceMappingURL=main.811935f7.chunk.js.map